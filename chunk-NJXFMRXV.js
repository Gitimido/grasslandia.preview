import{a as Y,b as J}from"./chunk-LIYFZQGL.js";import"./chunk-3SCB5KN2.js";import{s as B,t as U,u as $,v as Q}from"./chunk-ZFMLJ4I4.js";import"./chunk-5FDPCJE3.js";import{$ as a,Ba as k,G as w,J as p,K as m,L as b,La as I,M as C,Ma as F,Pa as R,T as M,V as o,W as _,Wa as T,Ya as L,Z as v,Za as E,ab as V,ba as x,bb as N,db as D,ea as r,eb as z,fa as n,ga as g,gb as q,hb as G,ib as j,ja as f,jb as A,ka as u,la as c,lb as H,m as y,ra as d,sa as S,ta as P,za as O}from"./chunk-UPP2GHVQ.js";import"./chunk-ZQOO3JOD.js";import"./chunk-HMJPAHNJ.js";var W=i=>["/profile",i];function X(i,t){if(i&1){let e=f();r(0,"div",3)(1,"div",4)(2,"button",5),u("click",function(){p(e);let s=c();return m(s.closePostDetail())}),b(),r(3,"svg",6),g(4,"path",7),n(),d(5," Back to search results "),n()(),C(),r(6,"div",8)(7,"app-post-card",9),u("deleted",function(s){p(e);let h=c();return m(h.handlePostDeleted(s))}),n(),r(8,"div",10),g(9,"app-comments-section",11),n()()()}if(i&2){let e=c();o(7),a("post",e.selectedPost),o(2),a("postId",e.selectedPost.id)}}function Z(i,t){i&1&&(r(0,"div",31),g(1,"div",32),r(2,"p"),d(3,"Searching..."),n()())}function ee(i,t){if(i&1){let e=f();r(0,"div",33)(1,"p"),d(2),n(),r(3,"button",34),u("click",function(){p(e);let s=c(2);return m(s.onSubmit())}),d(4,"Try Again"),n()()}if(i&2){let e=c(2);o(2),S(e.error)}}function te(i,t){if(i&1&&(r(0,"div",35)(1,"p"),d(2),n(),r(3,"p",36),d(4," Try using different keywords or checking your spelling. "),n()()),i&2){let e=c(2);o(2),P('No results found for "',e.searchQuery,'"')}}function ie(i,t){i&1&&(r(0,"h2"),d(1,"People"),n())}function re(i,t){if(i&1&&(r(0,"div",43)(1,"div",44),g(2,"img",45),n(),r(3,"div",46)(4,"h3",47),d(5),n(),r(6,"p",48),d(7),n()()()),i&2){let e=t.$implicit;a("routerLink",k(5,W,e.username)),o(2),a("src",e.avatarUrl||"/assets/default-avatar.png",M)("alt",e.fullName||e.username),o(3),P(" ",e.fullName||e.username," "),o(2),S(e.username)}}function oe(i,t){if(i&1&&(r(0,"div",40),v(1,ie,2,0,"h2",2),r(2,"div",41),v(3,re,8,7,"div",42),n()()),i&2){let e=c(3);o(),a("ngIf",e.activeFilter==="all"),o(2),a("ngForOf",e.users)}}function ne(i,t){i&1&&(r(0,"h2"),d(1,"Posts"),n())}function se(i,t){if(i&1){let e=f();r(0,"div",51),u("click",function(){let s=p(e).$implicit,h=c(4);return m(h.viewPostDetail(s))}),r(1,"app-post-card",9),u("deleted",function(s){p(e);let h=c(4);return m(h.handlePostDeleted(s))}),n()()}if(i&2){let e=t.$implicit;o(),a("post",e)}}function ae(i,t){if(i&1&&(r(0,"div",40),v(1,ne,2,0,"h2",2),r(2,"div",49),v(3,se,2,1,"div",50),n()()),i&2){let e=c(3);o(),a("ngIf",e.activeFilter==="all"),o(2),a("ngForOf",e.posts)}}function le(i,t){i&1&&(r(0,"span"),d(1,"Load More Results"),n())}function ce(i,t){i&1&&g(0,"span",55)}function de(i,t){if(i&1){let e=f();r(0,"div",52)(1,"button",53),u("click",function(){p(e);let s=c(3);return m(s.loadMore())}),v(2,le,2,0,"span",2)(3,ce,1,0,"span",54),n()()}if(i&2){let e=c(3);o(),a("disabled",e.isLoadingMore),o(),a("ngIf",!e.isLoadingMore),o(),a("ngIf",e.isLoadingMore)}}function pe(i,t){if(i&1&&(r(0,"div",37),v(1,oe,4,2,"div",38)(2,ae,4,2,"div",38)(3,de,4,3,"div",39),n()),i&2){let e=c(2);o(),a("ngIf",(e.activeFilter==="all"||e.activeFilter==="people")&&e.users.length>0),o(),a("ngIf",(e.activeFilter==="all"||e.activeFilter==="posts")&&e.posts.length>0),o(),a("ngIf",e.canLoadMore)}}function me(i,t){if(i&1){let e=f();r(0,"div")(1,"div",12)(2,"div",13)(3,"form",14),u("ngSubmit",function(){p(e);let s=c();return m(s.onSubmit())}),r(4,"div",15)(5,"span",16),b(),r(6,"svg",17),g(7,"path",18),n()(),C(),g(8,"input",19),r(9,"button",20),d(10,"Search"),n()()()()(),r(11,"div",21)(12,"div",22)(13,"div",23)(14,"h3"),d(15,"Filter Results"),n(),r(16,"div",24)(17,"button",25),u("click",function(){p(e);let s=c();return m(s.setFilter("all"))}),d(18," All Results "),n(),r(19,"button",25),u("click",function(){p(e);let s=c();return m(s.setFilter("posts"))}),d(20," Posts "),n(),r(21,"button",25),u("click",function(){p(e);let s=c();return m(s.setFilter("people"))}),d(22," People "),n()()()(),r(23,"div",26),v(24,Z,4,0,"div",27)(25,ee,5,1,"div",28)(26,te,5,1,"div",29)(27,pe,4,3,"div",30),n()()()}if(i&2){let e=c();o(3),a("formGroup",e.searchForm),o(14),x("active",e.activeFilter==="all"),o(2),x("active",e.activeFilter==="posts"),o(2),x("active",e.activeFilter==="people"),o(3),a("ngIf",e.isLoading),o(),a("ngIf",e.error),o(),a("ngIf",!e.isLoading&&!e.error&&e.noResults),o(),a("ngIf",!e.isLoading&&!e.error&&!e.noResults)}}var K=class i{constructor(t,e,l,s,h,ue){this.route=t;this.router=e;this.fb=l;this.sideNavService=s;this.searchService=h;this.postService=ue;this.searchForm=this.fb.group({query:[""]})}searchForm;searchQuery="";activeFilter="all";posts=[];users=[];selectedPost=null;isLoading=!1;isLoadingMore=!1;error=null;isSidebarCollapsed=!1;offset=0;limit=10;canLoadMore=!1;routeSubscription=null;sidebarSubscription=null;ngOnInit(){this.sidebarSubscription=this.sideNavService.sidebarState.subscribe(t=>{this.isSidebarCollapsed=t}),this.routeSubscription=this.route.queryParams.subscribe(t=>{let e=t.q,l=t.postId;l?this.loadPostDetail(l):e&&(this.searchQuery=e,this.searchForm.get("query")?.setValue(e),this.offset=0,this.selectedPost=null,this.performSearch(e))})}ngOnDestroy(){this.routeSubscription&&this.routeSubscription.unsubscribe(),this.sidebarSubscription&&this.sidebarSubscription.unsubscribe()}loadPostDetail(t){this.isLoading=!0,this.selectedPost=null,this.postService.getPost(t).subscribe({next:e=>{this.selectedPost=e,this.isLoading=!1},error:e=>{console.error("Error loading post:",e),this.error="Failed to load the post. It may have been deleted or is unavailable.",this.isLoading=!1}})}viewPostDetail(t){this.router.navigate([],{relativeTo:this.route,queryParams:{postId:t.id},queryParamsHandling:"merge"})}closePostDetail(){this.router.navigate([],{relativeTo:this.route,queryParams:{postId:null},queryParamsHandling:"merge"}),this.selectedPost=null}onSubmit(){let t=this.searchForm.get("query")?.value;t&&t.trim()&&this.router.navigate([],{relativeTo:this.route,queryParams:{q:t,postId:null},queryParamsHandling:"merge"})}setFilter(t){this.activeFilter!==t&&(this.activeFilter=t,this.offset=0)}performSearch(t){this.isLoading=!0,this.error=null,this.posts=[],this.users=[];let e=this.searchService.searchUsers(t,20),l=this.searchService.searchPosts(t,this.limit,this.offset);y({users:e,posts:l}).subscribe({next:s=>{this.users=s.users,this.posts=s.posts,this.canLoadMore=s.posts.length>=this.limit,this.offset=this.posts.length,this.isLoading=!1},error:s=>{console.error("Error searching:",s),this.error="An error occurred while searching. Please try again.",this.isLoading=!1}})}loadMore(){this.isLoadingMore||(this.isLoadingMore=!0,this.searchService.searchPosts(this.searchQuery,this.limit,this.offset).subscribe({next:t=>{this.posts=[...this.posts,...t],this.canLoadMore=t.length>=this.limit,this.offset=this.posts.length,this.isLoadingMore=!1},error:t=>{console.error("Error loading more results:",t),this.isLoadingMore=!1}}))}handlePostDeleted(t){this.selectedPost&&this.selectedPost.id===t&&this.closePostDetail(),this.posts=this.posts.filter(e=>e.id!==t)}get noResults(){return this.activeFilter==="all"?this.posts.length===0&&this.users.length===0:this.activeFilter==="posts"?this.posts.length===0:this.users.length===0}static \u0275fac=function(e){return new(e||i)(_(T),_(L),_(A),_(Q),_(Y),_(U))};static \u0275cmp=w({type:i,selectors:[["app-search-results"]],standalone:!0,features:[O],decls:4,vars:4,consts:[[1,"search-results-container"],["class","post-detail-view",4,"ngIf"],[4,"ngIf"],[1,"post-detail-view"],[1,"detail-header"],[1,"back-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z","fill","currentColor"],[1,"detail-content"],[3,"deleted","post"],[1,"comments-container"],[3,"postId"],[1,"search-header"],[1,"search-form"],[3,"ngSubmit","formGroup"],[1,"search-input-container"],[1,"search-icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","20","height","20"],["d","M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z","fill","currentColor"],["type","text","formControlName","query","placeholder","Search Grasslandia...","autofocus","",1,"search-input"],["type","submit",1,"search-btn"],[1,"search-content"],[1,"search-filters"],[1,"filter-section"],[1,"filter-options"],[1,"filter-btn",3,"click"],[1,"results-area"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","results-list",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"retry-btn",3,"click"],[1,"empty-state"],[1,"empty-suggestions"],[1,"results-list"],["class","results-section",4,"ngIf"],["class","load-more-container",4,"ngIf"],[1,"results-section"],[1,"people-results"],["class","person-card",3,"routerLink",4,"ngFor","ngForOf"],[1,"person-card",3,"routerLink"],[1,"person-avatar"],[3,"src","alt"],[1,"person-info"],[1,"person-name"],[1,"person-username"],[1,"posts-results"],["class","post-result-item",3,"click",4,"ngFor","ngForOf"],[1,"post-result-item",3,"click"],[1,"load-more-container"],[1,"load-more-btn",3,"click","disabled"],["class","loading-spinner-sm",4,"ngIf"],[1,"loading-spinner-sm"]],template:function(e,l){e&1&&(g(0,"app-side-nav"),r(1,"div",0),v(2,X,10,2,"div",1)(3,me,28,11,"div",2),n()),e&2&&(o(),x("sidebar-collapsed",l.isSidebarCollapsed),o(),a("ngIf",l.selectedPost),o(),a("ngIf",!l.selectedPost))},dependencies:[R,I,F,V,E,H,q,N,D,z,G,j,J,$,B],styles:[".search-results-container[_ngcontent-%COMP%]{margin-left:250px;min-height:100vh;background-color:var(--background-color);transition:margin-left var(--transition-normal);display:flex;flex-direction:column}.search-results-container.sidebar-collapsed[_ngcontent-%COMP%]{margin-left:68px}@media (max-width: 768px){.search-results-container[_ngcontent-%COMP%]{margin-left:68px}}.search-header[_ngcontent-%COMP%]{background-color:var(--card-background);padding:16px 24px;border-bottom:1px solid var(--border-color);box-shadow:var(--shadow);position:sticky;top:0;z-index:10}.search-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:var(--secondary-color);border-radius:20px;padding:8px 12px;width:100%;max-width:600px;margin:0 auto}.search-icon[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--text-color);opacity:.7;margin-right:8px}.search-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;font-size:15px;outline:none;padding:4px 0;color:var(--text-color)}.search-btn[_ngcontent-%COMP%]{background-color:var(--primary-color);color:#fff;border:none;border-radius:20px;padding:6px 12px;font-weight:500;cursor:pointer;transition:background-color var(--transition-fast)}.search-btn[_ngcontent-%COMP%]:hover{opacity:.9}.search-content[_ngcontent-%COMP%]{display:flex;padding:24px;gap:24px;flex:1;max-width:1200px;margin:0 auto;width:100%}.search-filters[_ngcontent-%COMP%]{width:250px;background-color:var(--card-background);border-radius:var(--radius-lg);box-shadow:var(--shadow);height:fit-content;border:1px solid var(--border-color)}.filter-section[_ngcontent-%COMP%]{padding:16px}.filter-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:12px;color:var(--text-color)}.filter-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.filter-btn[_ngcontent-%COMP%]{background-color:transparent;border:none;border-radius:var(--radius-md);padding:8px 12px;text-align:left;font-size:14px;color:var(--text-color);opacity:.7;cursor:pointer;transition:all var(--transition-fast)}.filter-btn[_ngcontent-%COMP%]:hover{background-color:var(--hover-color)}.filter-btn.active[_ngcontent-%COMP%]{background-color:var(--hover-color);color:var(--primary-color);font-weight:500;opacity:1}.results-area[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:16px}.results-section[_ngcontent-%COMP%]{background-color:var(--card-background);border-radius:var(--radius-lg);box-shadow:var(--shadow);padding:16px;margin-bottom:16px;border:1px solid var(--border-color)}.results-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:16px;color:var(--text-color)}.people-results[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:16px}.person-card[_ngcontent-%COMP%]{background-color:var(--secondary-color);border-radius:var(--radius-lg);padding:16px;display:flex;flex-direction:column;align-items:center;cursor:pointer;transition:all var(--transition-fast);border:1px solid var(--border-color)}.person-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:var(--shadow)}.person-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;overflow:hidden;margin-bottom:12px;background-color:var(--primary-color)}.person-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.person-info[_ngcontent-%COMP%]{text-align:center;width:100%}.person-name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;margin-bottom:4px;color:var(--text-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.person-username[_ngcontent-%COMP%]{font-size:13px;color:var(--text-color);opacity:.7;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.posts-results[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.post-result-item[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s,box-shadow .2s}.post-result-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--shadow)}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;background-color:var(--card-background);border-radius:var(--radius-lg);box-shadow:var(--shadow);border:1px solid var(--border-color)}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--secondary-color);border-top:3px solid var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--text-color);opacity:.7}.error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--error-color);margin-bottom:16px}.retry-btn[_ngcontent-%COMP%]{background-color:var(--error-color);color:#fff;border:none;border-radius:var(--radius-md);padding:8px 16px;font-weight:500;cursor:pointer;transition:all var(--transition-fast)}.retry-btn[_ngcontent-%COMP%]:hover{opacity:.9}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--text-color);margin-bottom:8px}.empty-suggestions[_ngcontent-%COMP%]{font-size:14px;color:var(--text-color);opacity:.7}.load-more-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:16px;margin-bottom:32px}.load-more-btn[_ngcontent-%COMP%]{background-color:var(--secondary-color);color:var(--text-color);border:none;border-radius:var(--radius-md);padding:8px 16px;font-weight:500;cursor:pointer;transition:all var(--transition-fast);display:flex;align-items:center;gap:8px}.load-more-btn[_ngcontent-%COMP%]:hover{background-color:var(--hover-color)}.load-more-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.loading-spinner-sm[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid var(--secondary-color);border-top:2px solid var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.post-detail-view[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:24px;width:100%}.detail-header[_ngcontent-%COMP%]{margin-bottom:16px}.back-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:var(--secondary-color);border:none;border-radius:20px;padding:8px 16px;font-size:14px;color:var(--text-color);cursor:pointer;transition:all var(--transition-fast)}.back-btn[_ngcontent-%COMP%]:hover{background-color:var(--hover-color)}.detail-content[_ngcontent-%COMP%]{background-color:var(--card-background);border-radius:var(--radius-lg);box-shadow:var(--shadow);overflow:hidden;border:1px solid var(--border-color)}.comments-container[_ngcontent-%COMP%]{padding:16px;border-top:1px solid var(--border-color)}@media (max-width: 768px){.search-results-container[_ngcontent-%COMP%]{margin-left:68px}.search-content[_ngcontent-%COMP%]{flex-direction:column;padding:16px}.search-filters[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.people-results[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}.post-detail-view[_ngcontent-%COMP%]{padding:16px}}"]})};export{K as SearchResultsComponent};
