import{c as V}from"./chunk-3SCB5KN2.js";import{f as A}from"./chunk-5FDPCJE3.js";import{$ as n,C as _,E as l,G as x,J as M,Ja as F,K as O,Lb as m,Ma as R,O as U,Pa as z,Qa as b,S as I,T as S,V as i,W as f,X as k,Z as p,ba as h,c as T,ea as a,fa as s,ga as g,ja as w,ka as y,la as d,ra as u,sa as j,ta as D,v as C,za as E}from"./chunk-UPP2GHVQ.js";function H(o,t){if(o&1&&(a(0,"span"),u(1),s()),o&2){let e=d();i(),j(e.currentImageUrl?"Change":"Upload")}}function W(o,t){o&1&&g(0,"span",10)}function q(o,t){if(o&1){let e=w();a(0,"button",11),y("click",function(){M(e);let c=d();return O(c.removeProfilePicture())}),u(1," Remove "),s()}}function G(o,t){if(o&1&&(a(0,"div",12),u(1),s()),o&2){let e=d();i(),D(" ",e.errorMessage," ")}}var B=class o{constructor(t,e){this.mediaService=t;this.authService=e;this.loadCurrentProfilePicture()}pictureChanged=new U;currentImageUrl=null;isUploading=!1;errorMessage=null;loadCurrentProfilePicture(){let t=this.authService.user?.id;t&&this.mediaService.getUserProfileMedia(t).subscribe(e=>{e&&(this.currentImageUrl=e.url)})}onFileSelected(t){let e=t.target;if(!e.files||e.files.length===0)return;let r=e.files[0];if(!r.type.startsWith("image/")){this.errorMessage="Please select an image file.";return}if(r.size>5*1024*1024){this.errorMessage="Image size should be less than 5MB.";return}this.uploadProfilePicture(r)}uploadProfilePicture(t){this.isUploading=!0,this.errorMessage=null,this.mediaService.uploadProfilePicture(t).pipe(C(()=>this.isUploading=!1)).subscribe({next:e=>{this.currentImageUrl=e.url,this.pictureChanged.emit(e)},error:e=>{console.error("Error uploading profile picture:",e),this.errorMessage="Failed to upload profile picture. Please try again."}})}removeProfilePicture(){this.currentImageUrl=null,this.pictureChanged.emit(null)}static \u0275fac=function(e){return new(e||o)(f(A),f(m))};static \u0275cmp=x({type:o,selectors:[["app-profile-picture-uploader"]],outputs:{pictureChanged:"pictureChanged"},standalone:!0,features:[E],decls:10,vars:10,consts:[[1,"profile-picture-uploader"],[1,"profile-avatar"],["alt","Profile picture",3,"src"],[1,"overlay"],[1,"upload-button"],[4,"ngIf"],["class","spinner",4,"ngIf"],["type","file","accept","image/*",3,"change","disabled"],["class","remove-button",3,"click",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"spinner"],[1,"remove-button",3,"click"],[1,"error-message"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"div",1),g(2,"img",2),a(3,"div",3)(4,"label",4),p(5,H,2,1,"span",5)(6,W,1,0,"span",6),a(7,"input",7),y("change",function(P){return r.onFileSelected(P)}),s()(),p(8,q,2,0,"button",8),s()(),p(9,G,2,1,"div",9),s()),e&2&&(i(),h("has-image",r.currentImageUrl),i(),n("src",r.currentImageUrl||"/assets/default-avatar.png",S),i(2),h("uploading",r.isUploading),i(),n("ngIf",!r.isUploading),i(),n("ngIf",r.isUploading),i(),n("disabled",r.isUploading),i(),n("ngIf",r.currentImageUrl&&!r.isUploading),i(),n("ngIf",r.errorMessage))},dependencies:[z,R],styles:[".profile-picture-uploader[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.profile-avatar[_ngcontent-%COMP%]{position:relative;width:150px;height:150px;border-radius:50%;overflow:hidden;background-color:#f0f0f0}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.profile-avatar[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;flex-direction:column;justify-content:center;align-items:center;opacity:0;transition:opacity .3s}.profile-avatar[_ngcontent-%COMP%]:hover   .overlay[_ngcontent-%COMP%]{opacity:1}.profile-avatar.has-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{background:#000000b3}.upload-button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#4a90e2;color:#fff;border-radius:4px;cursor:pointer;font-size:14px;margin-bottom:8px}.upload-button[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.upload-button.uploading[_ngcontent-%COMP%]{background-color:#3a7bc8;cursor:not-allowed}.upload-button[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.remove-button[_ngcontent-%COMP%]{padding:6px 12px;background-color:#e74c3c;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px}.error-message[_ngcontent-%COMP%]{margin-top:12px;color:#e74c3c;font-size:14px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};var N=class o{constructor(t,e,r,c,P){this.document=e;this.platformId=r;this.userService=c;this.authService=P;this.renderer=t.createRenderer(null,null),this.initializeTheme(),this.authService.user$.subscribe(v=>{v&&this.loadUserTheme(v.id)})}renderer;currentThemeSubject=new T("light");uiToDbThemeMap={light:"light",dark:"dark","night-blue":"blue","green-grass":"green"};dbToUiThemeMap={light:"light",dark:"dark",blue:"night-blue",green:"green-grass",purple:"light"};get currentTheme$(){return this.currentThemeSubject.asObservable()}getDbThemeValue(t){return this.uiToDbThemeMap[t]||"light"}getUiThemeValue(t){return this.dbToUiThemeMap[t]||"light"}initializeTheme(){if(b(this.platformId)){let e=localStorage.getItem("theme")||"night-blue";this.setTheme(e)}}loadUserTheme(t){this.userService.getUserById(t).subscribe({next:e=>{if(e&&e.theme){let r=e.theme,c=this.getUiThemeValue(r);this.setTheme(c)}},error:e=>{console.error("Error loading user theme:",e)}})}setTheme(t){b(this.platformId)&&(localStorage.setItem("theme",t),this.removeAllThemeClasses(),this.renderer.addClass(this.document.body,`theme-${t}`),this.updateThemeVariables(t),this.currentThemeSubject.next(t))}removeAllThemeClasses(){["theme-light","theme-dark","theme-night-blue","theme-green-grass","theme-blue","theme-green","theme-purple"].forEach(e=>{this.renderer.removeClass(this.document.body,e)})}updateThemeVariables(t){let e=this.document.documentElement;switch(t){case"light":e.style.setProperty("--background-color","#f0f2f5"),e.style.setProperty("--text-color","#1c1e21"),e.style.setProperty("--card-background","#ffffff"),e.style.setProperty("--primary-color","#1877f2"),e.style.setProperty("--secondary-color","#e4e6eb"),e.style.setProperty("--border-color","#dddfe2"),e.style.setProperty("--hover-color","#f5f7fa"),e.style.setProperty("--accent-color","#4a90e2"),e.style.setProperty("--success-color","#42b72a"),e.style.setProperty("--error-color","#e41e3f"),e.style.setProperty("--shadow","0 2px 8px rgba(0, 0, 0, 0.1)");break;case"dark":e.style.setProperty("--background-color","#18191a"),e.style.setProperty("--text-color","#e4e6eb"),e.style.setProperty("--card-background","#242526"),e.style.setProperty("--primary-color","#2d88ff"),e.style.setProperty("--secondary-color","#3a3b3c"),e.style.setProperty("--border-color","#3e4042"),e.style.setProperty("--hover-color","#303132"),e.style.setProperty("--accent-color","#4a90e2"),e.style.setProperty("--success-color","#42b72a"),e.style.setProperty("--error-color","#e41e3f"),e.style.setProperty("--shadow","0 2px 8px rgba(0, 0, 0, 0.3)");break;case"night-blue":e.style.setProperty("--background-color","#1a2a3a"),e.style.setProperty("--text-color","#ffffff"),e.style.setProperty("--card-background","#2c3e50"),e.style.setProperty("--primary-color","#3498db"),e.style.setProperty("--secondary-color","#34495e"),e.style.setProperty("--border-color","#435b71"),e.style.setProperty("--hover-color","#2d4256"),e.style.setProperty("--accent-color","#5dade2"),e.style.setProperty("--success-color","#2ecc71"),e.style.setProperty("--error-color","#e74c3c"),e.style.setProperty("--shadow","0 2px 8px rgba(0, 0, 0, 0.4)");break;case"green-grass":e.style.setProperty("--background-color","#e8f5e9"),e.style.setProperty("--text-color","#2e7d32"),e.style.setProperty("--card-background","#ffffff"),e.style.setProperty("--primary-color","#4caf50"),e.style.setProperty("--secondary-color","#c8e6c9"),e.style.setProperty("--border-color","#a5d6a7"),e.style.setProperty("--hover-color","#f1f8f1"),e.style.setProperty("--accent-color","#66bb6a"),e.style.setProperty("--success-color","#43a047"),e.style.setProperty("--error-color","#e53935"),e.style.setProperty("--shadow","0 2px 8px rgba(0, 0, 0, 0.1)");break}}static \u0275fac=function(e){return new(e||o)(l(k),l(F),l(I),l(V),l(m))};static \u0275prov=_({token:o,factory:o.\u0275fac,providedIn:"root"})};export{B as a,N as b};
